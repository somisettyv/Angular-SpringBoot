<!DOCTYPE html>
<html ng-app="app">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mock Testing Portal</title>
  <!--theme: Bootstrap 3, Bootstrap 2, default-->
  <link href="libs/bootstrap/3.0.0/css/bootstrap.css" rel="stylesheet" media="screen">
  <!--xeditable css-->
  <link href="dist/css/xeditable.css" rel="stylesheet" media="screen">
  <!--docs css-->
  <link href="docs/css/docs.css" rel="stylesheet" media="screen">
  <!--angular-->
  <script src="libs/angular/1.2.7/angular.js"></script>
  <script src="libs/angular/1.2.7/angular-mocks.js"></script>
  <!--jquery (needed for bootstrap)-->
  <script src="libs/jquery/jquery-1.10.2.min.js"></script>
  <!--bootstrap-->
  <script src="libs/bootstrap/3.0.0/js/bootstrap.js"></script>
  <!--angular-ui-bootstrap-->
  <script src="libs/angular-ui/bootstrap/ui-bootstrap-tpls-0.6.0.min.js"></script>
  <!--moment-->
  <script src="libs/moment.min.2.5.0.js"></script>
  <!--google-code-prettify-->
  <script src="libs/google-code-prettify/run_prettify.js"></script>
  <!--checklist-model-->
  <script src="libs/checklist-model.js"></script>
  <!--app-->
  <script src="docs/js/app.js"></script>
  <!--xeditable-->
  <script src="dist/js/xeditable.min.js"></script>
</head>

<body data-spy="scroll" data-target=".sidebar">
  <nav role="navigation" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" data-toggle="collapse" data-target=".navbar-ex1-collapse" class="navbar-toggle">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="#" class="navbar-brand">Angular-xeditable </a>
      </div>
      <div class="collapse navbar-collapse navbar-ex1-collapse">
        <ul class="nav navbar-nav">
          <li class="active">
            <a href="#">Home</a>
          </li>
          <li>
            <a href="https://github.com/vitalets/angular-xeditable">Github</a>
          </li>
        </ul>
        <form class="navbar-form navbar-right">
          <a href="zip/angular-xeditable-0.1.9.zip" style="font-weight:bold" class="btn btn-primary">
            <span style="margin-right:10px" class="glyphicon glyphicon-save"></span>Download 0.1.9 ~ 26kb</a>
        </form>
        <div style="padding-top: 13px">
          <!-- google+ -->
          <div id="socials" style="text-align: center">
            <div style="display: inline-block" class="g-plusone" data-size="medium" data-href="http://vitalets.github.io/angular-xeditable"></div>
            <script type="text/javascript">
              (function () {
                if (!isProd()) return;
                var po = document.createElement('script');
                po.type = 'text/javascript';
                po.async = true;
                po.src = 'https://apis.google.com/js/plusone.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(po, s);
              })();
            </script>


            <!-- facebook -->
            <div id="fb-root" style="display: inline-block"></div>
            <script>
              (function (d, s, id) {
                if (!isProd()) return;
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s);
                js.id = id;
                js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=558710054143871";
                fjs.parentNode.insertBefore(js, fjs);
              }(document, 'script', 'facebook-jssdk'));
            </script>
            <div style="vertical-align:top;zoom:1;*display:inline;display: inline-block; text-align:left; margin: 1px 30px 0 0" class="fb-like"
              data-href="http://vitalets.github.io/angular-xeditable" data-send="false" data-layout="button_count" data-width1="450"
              data-show-faces="false"></div>


            <!-- twitter -->
            <a style="vertical-align:top" href="https://twitter.com/share" class="twitter-share-button" data-url="http://vitalets.github.io/angular-xeditable"
              data-via="xeditable">Tweet</a>
            <script>
              ! function (d, s, id) {
                if (!isProd()) return;
                var js, fjs = d.getElementsByTagName(s)[0];
                if (!d.getElementById(id)) {
                  js = d.createElement(s);
                  js.id = id;
                  js.src = "//platform.twitter.com/widgets.js";
                  fjs.parentNode.insertBefore(js, fjs);
                }
              }(document, "script", "twitter-wjs");
            </script>
          </div>
        </div>
      </div>
    </div>
  </nav>
  <div class="container">
    <div class="row">
      <div class="col-sm-3 col-xs-12">
        <div class="well sidebar">
          <ul class="nav">
            <li>
              <a href="#overview">billAutopayOff</a>
              <ul class="nav">
              </ul>
            </li>
            <li>
              <a href="#getstarted">billAutopayOnAndActive</a>
              <ul class="nav">
              </ul>
            </li>
            <li>
              <a href="#text-simple">billAutopayOnButInactive</a>

            </li>
            <li>
              <a href="#text-customize">espContractDetail</a>
              <ul class="nav">
                <li>
                  <a href="#text-customize">Customize input</a>
                </li>
                <li>
                  <a href="#text-btn">Trigger manually</a>
                </li>
                <li>
                  <a href="#select-nobuttons">Hide buttons</a>
                </li>
                <li>
                  <a href="#select-multiple">Select multiple</a>
                </li>
                <li>
                  <a href="#validate-local">Validate local</a>
                </li>
                <li>
                  <a href="#validate-remote">Validate remote</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#onbeforesave">Submit</a>
              <ul class="nav">
                <li>
                  <a href="#onbeforesave">Onbeforesave</a>
                </li>
                <li>
                  <a href="#onaftersave">Onaftersave</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#editable-form">Forms</a>
              <ul class="nav">
                <li>
                  <a href="#editable-form">Editable form</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#editable-row">Tables</a>
              <ul class="nav">
                <li>
                  <a href="#editable-row">Editable row</a>
                </li>
                <li>
                  <a href="#editable-column">Editable column</a>
                </li>
                <li>
                  <a href="#editable-table">Editable table</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#bootstrap3">Themes</a>
              <ul class="nav">
                <li>
                  <a href="#bootstrap3">Bootstrap 3</a>
                </li>
                <li>
                  <a href="#bootstrap2">Bootstrap 2</a>
                </li>
                <li>
                  <a href="#default">Default</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#ref-element">Reference</a>
              <ul class="nav">
                <li>
                  <a href="#ref-element">Editable element</a>
                </li>
                <li>
                  <a href="#ref-form">Editable form</a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>




      <div class="col-sm-9 col-xs-12">
        <!-- render-->
        <section id="overview"></section>
        <h1>Overview</h1>

        <div ng-controller="EditableFormCtrl">
          <form editable-form name="editableForm" onbeforesave="saveUser()">

            <div class="buttons">
              <!-- button to show form -->
              <button type="button" class="btn btn-default" ng-click="editableForm.$show()" ng-show="!editableForm.$visible">
                Edit
              </button>
              <button type="button" class="btn btn-default" ng-click="editableForm.$show()" ng-show="!editableForm.$visible">
                Clone
              </button>
              <button type="button" class="btn btn-default" ng-click="editableForm.$show()" ng-show="!editableForm.$visible">
                Run
              </button>
              <!-- buttons to submit / cancel form -->
              <span ng-show="editableForm.$visible">
                <button type="submit" class="btn btn-primary" ng-disabled="editableForm.$waiting" ng-click="cloneUser(false)">
                  Save
                </button>
                <button type="submit" class="btn btn-default" ng-disabled="editableForm.$waiting" ng-click="cloneUser(true)">
                  Save New
                </button>
                <button type="button" class="btn btn-default" ng-disabled="editableForm.$waiting" ng-click="editableForm.$cancel()">
                  Cancel
                </button>
              </span>
            </div>

            <div>
              <!-- editable group (select-remote) -->
              <span class="title">Scenario List: </span>
              <span editable-select="user.group" e-name="group" onshow="loadGroups()" e-ng-options="g.id as g.text for g in groups">
                {{ showGroup() }}
              </span>
            </div>

            <div>
              <!-- editable username (text with validation) -->
              <span class="title">Scenario Name: </span>
              <span style="width:30%" editable-textarea="user.name" e-name="name" e-required e-rows="1" e-cols="40">{{ user.name || 'empty' }}</span>
            </div>

            <div class='container'>
              <div class="row">
                <div class="col-md-12">
                  <!-- editable username (text with validation) -->
                  <span class="title">Response: </span>
                  <span style="width:100%" editable-textarea="user.response" e-name="response" e-required e-rows="100" e-cols="100">{{ user.response || 'empty' }}</span>
                </div>
              </div>
            </div>


          </form>
        </div>


        </section>




        <!--script(src=dir+'/controller.js')-->
        <script>
          app.controller('EditableFormCtrl', function ($scope, $filter, $http) {

            $scope.cloneFlag = false

            $scope.user = {
              id: 1,
              name: 'awesome user',
              status: 2,
              group: 4,
              groupName: 'admin',
              response: "This is a Test Eesppp"
            };

            $scope.statuses = [{
                value: 1,
                text: 'status1'
              },
              {
                value: 2,
                text: 'status2'
              },
              {
                value: 3,
                text: 'status3'
              },
              {
                value: 4,
                text: 'status4'
              }
            ];

            $scope.groups = [];
            $scope.loadGroups = function () {
              return $scope.groups.length ? null : $http.get('/groups').success(function (data) {
                $scope.groups = data;
              });
            };

            $scope.showGroup = function () {

              if ($scope.groups.length) {
                //window.alert($scope.user.group)
                //window.alert($scope.editableForm.group.$viewValue);

                //http://localhost:8080/scenario/1SR_device_level_refresh_failure_status_code_non_1500/response/postRefreshToXray


                var selected = $filter('filter')($scope.groups, {
                  id: $scope.editableForm.group.$viewValue
                });
                $scope.user.name = selected[0].text;

                return selected.length ? selected[0].text : 'Not set';
              } else {
                return $scope.user.groupName;
              }
            };

            $scope.checkName = function (data) {
              if (data !== 'awesome' && data !== 'error') {
                return "Username should be `awesome` or `error`";
              }
            };



            $scope.saveUser = function () {
              // $scope.user already updated!
              window.alert($scope.cloneFlag);

              if ($scope.cloneFlag) {


                return $http.post('/updateUser', $scope.user).error(function (err) {
                  if (err.field && err.msg) {
                    // err like {field: "name", msg: "Server-side error for this username!"}
                    $scope.editableForm.$setError(err.field, err.msg);
                  } else {
                    // unknown error
                    $scope.editableForm.$setError('name', 'Unknown error!');
                  }
                });
              } else {

                //$location.path('/newValue');

                var headers = {
                  'Access-Control-Allow-Origin': 'http://10.0.1.13:8080/',
                  'Access-Control-Allow-Methods': 'POST, GET, OPTIONS, PUT',
                  'Content-Type': 'application/json',
                  'Accept': 'application/json'
                };

                $http({
                  method: 'GET',
                  url: 'http://10.0.1.13:8080/scenario/1SR_device_level_refresh_failure_status_code_non_1500/response/postRefreshToXray',
                  headers: headers
                }).then(function successCallback(response) {
                  // this callback will be called asynchronously
                  // when the response is available
                  $scope.user.response = response;
                }, function errorCallback(response) {
                  // called asynchronously if an error occurs
                  // or server returns response with an error status.
                  window.alert("response errorrrrr");
                });

                return $http.post('/saveUser', $scope.user).error(function (err) {
                  if (err.field && err.msg) {
                    // err like {field: "name", msg: "Server-side error for this username!"} 
                    $scope.editableForm.$setError(err.field, err.msg);
                  } else {
                    // unknown error
                    $scope.editableForm.$setError('name', 'Unknown error!');
                  }
                });
              }
            };

            $scope.cloneUser = function (flag) {
              $scope.cloneFlag = flag;
            };





          });
        </script>



</body>

</html>